<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

	<title>Kranc Tutorial</title>
        <link rel=StyleSheet href="style.css" type="text/css">

</head>
<body>


<h1>Kranc Tutorial</h1>

<p>This tutorial is in four parts.  The first part describes how to
download and configure Cactus, and can be skipped if you are already
familiar with Cactus and have an existing Cactus installation that you
want to use.  The second part describes how to download and install
Kranc into your Cactus installation. The third part describes how to
generate the SimpleWave example thorn and compile it.  The fourth part
describes how to run the example and analyse the output.</p>

<p>Prerequisites:
<ul>
<li>Mathematica</li>
<li>A C and C++ compiler</li>
<li>The <a href = "http://git-scm.com/">Git</a> version control system</li>
<li>A Unix-type operating system (e.g. Linux or Mac OS)
</ul>
</p>

<h2>Download and install Cactus</h2>

<p>The first step is to create a Cactus directory. Everything will
then be downloaded into this directory and compiled there.

<pre>
mkdir Cactus
cd Cactus
</pre>

<p>Download the Cactus <i>GetComponents</i> script and make it
executable. This script allows you to download Cactus thorns from many
different repositories listed in a <i>ThornList</i>.

<pre>
wget http://www.cactuscode.org/download/GetComponents
chmod u+x GetComponents
</pre>

<p>Download Cactus:

<pre>./GetComponents -a --root=. http://cactuscode.org/download/thorns/ComputationalToolkitBasic.th</pre>

<p>After several minutes, Cactus should have been downloaded.</p>

<h2>Install Kranc into your Cactus directory</h2>

<p>Download the Kranc distribution (you will need the <i>git</i>
version control program installed):

<!-- <pre> -->
<!-- wget http://github.com/ianhinder/Kranc/tarball/master -->
<!-- tar xfz *-Kranc-*.tar.gz -->
<!-- mv *-Kranc-* Kranc -->
<!-- </pre> -->

<pre>git clone git://github.com/ianhinder/Kranc</pre></p>

<p>Link Kranc into your Cactus installation:
<pre>
ln -s ../Kranc/Auxiliary/Cactus/KrancNumericalTools arrangements/KrancNumericalTools
ln -s ../Kranc/Examples arrangements/KrancExamples
</pre>

<p>Kranc is now installed and ready to use.</p>

<h2>Build the SimpleWave example</h2>

<p>Go into the Examples directory and run Kranc to build the SimpleWave thorn:

<pre>
cd Kranc/Examples
../../Kranc/Bin/kranc SimpleWave.m
</pre>

<p>There should be a new directory, SimpleWave, which is the Cactus
thorn which has been newly generated from the SimpleWave.m Kranc
script.</p>

<p>Return to the Cactus directory and copy the example Cactus thornlist:
<pre>
cd ../..
cp ComputationalToolkitBasic.th kranc.th</pre>

<p>Open kranc.th in an editor and add the following lines to it:
<pre>
KrancNumericalTools/GenericFD
KrancExamples/SimpleWave
</pre></p>

<p>Create a Cactus configuration called "kranc" using this thornlist:
<pre>
make kranc-config THORNLIST=kranc.th
</pre></p>

<p>If a C compiler cannot be found, or there is some other error,
consult the <a href = "http://cactuscode.org/documentation">Cactus
documentation</a> for advice on configuring Cactus for your system.
You may have to write an <i>optionlist</i> for your system and use it
in the "make kranc-config" line.</p>

<p>Build the configuration:
<pre>
make kranc
</pre>
</p>

<p>The configuration containing the Kranc-generated thorn should now
have been built.  The executable will be exe/cactus_kranc and the
intermediate build files will be in configs/kranc.</p>

<h2>Run the SimpleWave example</h2>

<p>Run Cactus with the parameter file simplewave_test.par:

<pre>
cd Kranc/Examples
../../exe/cactus_kranc simplewave_test.par
</pre>

<p>You should see many lines of output as Cactus runs.  If the test
finishes successfully, the final line should be "Done."</p>

<p>
The output will be in the directory simplewave_test.  The variable
phi is stored as a 1D timeseries in simplewave_test/phi.xl.  You can
visualise it, for example, with Mathematica.  Create a new notebook
and save it in the Examples directory (for example as "Analysis.nb").
In the notebook, type</p>

<pre>
SetDirectory[NotebookDirectory[]];
</pre>
<pre>
Get["../Auxiliary/Cactus/IOASCII.m"];
</pre>
<pre>
MGraph[ReadIOASCII["simplewave_sine/phi.xl"]]
</pre>

<p>You should see a sine wave.  Use the Manipulate slider to animate
the display to see the different iterations of the simulation.  The
data file can also be read using the ygraph plotting program.</p>

<div><img src="sineplot.png"></div>

</body>
</html>
